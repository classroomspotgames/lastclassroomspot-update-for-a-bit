<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CodeLearn - Student Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" href="favicon.ico">
<style>
  :root {
    --primary: #667eea;
    --primary-hover: #5a67d8;
    --secondary: #764ba2;
    --bg-light: #f0f2f5;
    --text-dark: #1f2937;
    --glass-bg: rgba(255, 255, 255, 0.85);
    --glass-border: rgba(255, 255, 255, 0.3);
    --shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    background: var(--bg-light);
    min-height: 100vh;
    overflow-x: hidden;
    color: var(--text-dark);
  }

  /* --- Login Screen --- */
  .login-screen {
    position: fixed;
    inset: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    transition: opacity 0.5s ease;
  }

  .login-screen.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .login-box {
    background: var(--glass-bg);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    padding: 40px;
    border-radius: 24px;
    box-shadow: var(--shadow);
    width: 90%;
    max-width: 400px;
    text-align: center;
    position: relative;
    animation: slideUp 0.6s ease-out;
  }

  @keyframes slideUp {
    from { transform: translateY(30px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .login-banner {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    margin-bottom: 20px;
    object-fit: cover;
    border: 4px solid white;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  }

  .login-box h1 {
    color: var(--text-dark);
    margin-bottom: 10px;
    font-size: 28px;
  }

  .login-box p {
    color: #666;
    margin-bottom: 30px;
    font-size: 14px;
  }

  .login-input {
    width: 100%;
    padding: 15px 20px;
    margin-bottom: 15px;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    font-size: 16px;
    transition: all 0.3s;
    outline: none;
    background: rgba(255,255,255,0.9);
  }

  .login-input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
  }

  .login-btn {
    width: 100%;
    padding: 15px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .login-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
  }

  .error-msg {
    color: #e60012;
    margin-top: 15px;
    font-size: 14px;
    display: none;
    font-weight: 500;
  }

  /* More Info Section */
  .more-info-container {
    margin-top: 20px;
    position: relative;
  }

  .more-info-btn {
    background: transparent;
    border: 1px solid #ccc;
    color: #666;
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.3s;
  }

  .more-info-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
  }

  .info-tooltip {
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%) scale(0.9);
    background: #333;
    color: white;
    padding: 15px;
    border-radius: 12px;
    width: 90%;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    z-index: 10;
  }

  .info-tooltip.active {
    opacity: 1;
    transform: translateX(-50%) scale(1);
    bottom: 140%;
  }

  .info-tooltip::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -8px;
    border-width: 8px;
    border-style: solid;
    border-color: #333 transparent transparent transparent;
  }

  .info-tooltip p {
    margin: 5px 0;
    font-size: 13px;
    color: #fff;
  }
  .info-tooltip strong { color: #ffd700; }

  /* --- Intro Screen --- */
  .intro-screen {
    position: fixed;
    inset: 0;
    background: #000;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    flex-direction: column;
  }
  .intro-screen.active { display: flex; }
  .intro-gif {
    max-width: 200px;
    border-radius: 20px;
    margin-bottom: 20px;
  }
  .intro-text {
    color: white;
    font-size: 20px;
    letter-spacing: 2px;
    animation: pulse 1.5s infinite;
  }
  @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

  /* --- Feedback Popup --- */
  .feedback-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    background: white;
    padding: 30px;
    border-radius: 24px;
    box-shadow: 0 25px 80px rgba(0,0,0,0.3);
    z-index: 10001;
    max-width: 400px;
    width: 90%;
    text-align: center;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s ease;
  }
  .feedback-popup.active {
    opacity: 1;
    pointer-events: all;
    transform: translate(-50%, -50%) scale(1);
  }
  .feedback-popup h2 {
    color: #333;
    margin-bottom: 15px;
    font-size: 22px;
  }
  .feedback-popup p {
    color: #666;
    margin-bottom: 20px;
    font-size: 14px;
    line-height: 1.5;
  }
  .feedback-buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
  }
  .feedback-btn {
    padding: 12px 24px;
    border: none;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  .vote-btn {
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: white;
  }
  .vote-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
  }
  .exit-btn {
    background: #f0f0f0;
    color: #666;
  }
  .exit-btn:hover {
    background: #e0e0e0;
  }

  /* --- Main Site --- */
  .main-site {
    display: none;
    min-height: 100vh;
    flex-direction: column;
    background: var(--bg-light);
    padding-bottom: 100px;
  }
  .main-site.active { display: flex; }

  /* Header */
  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 40px;
    background: white;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    z-index: 100;
    position: sticky;
    top: 0;
  }

  .logo-section {
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .logo-banner {
    height: 40px;
    border-radius: 8px;
  }

  .site-title {
    color: #333;
    font-size: 22px;
    font-weight: 700;
  }

  .header-controls {
    display: flex;
    align-items: center;
    gap: 20px;
  }

  /* Search Bar */
  .search-container {
    position: relative;
  }
  .search-input {
    padding: 10px 15px 10px 35px;
    border: 1px solid #ddd;
    border-radius: 20px;
    width: 250px;
    font-size: 14px;
    outline: none;
    transition: all 0.3s;
  }
  .search-input:focus {
    width: 300px;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  .search-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #999;
    font-size: 14px;
  }

  .total-games {
    color: white;
    background: #e60012;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: 600;
  }

  .time-display {
    color: #666;
    font-size: 14px;
    font-weight: 500;
    font-family: monospace;
  }

  /* Games Container - Nintendo Switch Style Horizontal Scroll */
  .games-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 40px 0;
    position: relative;
    overflow: hidden;
  }

  .games-scroll-area {
    width: 100%;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    padding: 20px 40px;
  }
  .games-scroll-area::-webkit-scrollbar { display: none; }

  .games-row {
    display: flex;
    gap: 25px;
    width: max-content;
    padding: 20px;
  }

  .game-card {
    width: 200px;
    height: 200px;
    border-radius: 20px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    background: white;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    border: 3px solid transparent;
    position: relative;
    flex-shrink: 0;
  }

  .game-card:hover, .game-card.focused {
    transform: translateY(-10px) scale(1.05);
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    border-color: var(--primary);
  }

  .game-card.favorite { border-color: #ffd700; }
  
  .game-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s;
  }
  .game-card:hover img, .game-card.focused img { transform: scale(1.1); }

  .game-card .star {
    position: absolute;
    top: 10px;
    left: 10px;
    color: #ffd700;
    font-size: 24px;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    z-index: 2;
    cursor: pointer;
    transition: transform 0.2s;
  }
  .game-card .star:hover { transform: scale(1.2); }
  .game-card .star.empty { color: rgba(255,255,255,0.6); }

  .game-card .title {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 15px;
    background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 100%);
    color: white;
    font-size: 14px;
    font-weight: 600;
    text-align: center;
    opacity: 0;
    transition: opacity 0.3s;
  }
  .game-card:hover .title, .game-card.focused .title { opacity: 1; }

  /* Scroll Buttons */
  .scroll-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 50px;
    height: 50px;
    background: rgba(255, 255, 255, 0.9);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    z-index: 10;
    transition: all 0.3s;
  }
  .scroll-btn:hover {
    background: var(--primary);
    transform: translateY(-50%) scale(1.1);
  }
  .scroll-btn:hover svg {
    fill: white;
  }
  .scroll-btn svg {
    width: 24px;
    height: 24px;
    fill: #333;
    transition: fill 0.3s;
  }
  .scroll-btn-left {
    left: 20px;
  }
  .scroll-btn-right {
    right: 20px;
  }

  /* Fullscreen Game Player */
  .game-player {
    position: fixed;
    inset: 0;
    background: #000;
    z-index: 9998;
    display: none;
    flex-direction: column;
  }
  .game-player.active {
    display: flex;
  }
  .game-player-header {
    display: flex;
    align-items: center;
    padding: 15px 20px;
    background: #1a1a1a;
    border-bottom: 1px solid #333;
    gap: 15px;
  }
  .home-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }
  .home-btn:hover {
    background: var(--primary-hover);
    transform: translateY(-1px);
  }
  .home-btn svg {
    width: 18px;
    height: 18px;
    fill: currentColor;
  }
  .game-player-title {
    color: white;
    font-size: 16px;
    font-weight: 600;
    flex: 1;
    text-align: center;
  }
  .game-frame {
    flex: 1;
    width: 100%;
    border: none;
    background: #000;
  }

  /* Fullscreen button */
  .fullscreen-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 20px;
    background: #28a745;
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    margin-left: auto;
  }
  .fullscreen-btn:hover {
    background: #218838;
    transform: translateY(-1px);
  }
  .fullscreen-btn svg {
    width: 18px;
    height: 18px;
    fill: currentColor;
  }

  /* Fullscreen exit overlay */
  .fullscreen-exit-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 80px;
    background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
    display: flex;
    justify-content: flex-end;
    align-items: flex-start;
    padding: 20px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    z-index: 10;
  }
  .game-player.fullscreen .fullscreen-exit-overlay {
    pointer-events: all;
  }
  .game-player.fullscreen .fullscreen-exit-overlay:hover {
    opacity: 1;
  }
  .fullscreen-exit-btn {
    background: #e60012;
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    transition: all 0.2s;
  }
  .fullscreen-exit-btn:hover {
    background: #c00010;
    transform: scale(1.1);
  }

  /* Hide header in fullscreen */
  .game-player.fullscreen .game-player-header {
    display: none;
  }

  /* My List Section */
  .my-list-section {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0.9);
    background: white;
    padding: 30px;
    border-radius: 24px;
    box-shadow: 0 25px 80px rgba(0,0,0,0.2);
    z-index: 1002;
    max-width: 900px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    display: none;
    opacity: 0;
    transition: all 0.3s ease;
  }
  .my-list-section.active {
    display: block;
    opacity: 1;
    transform: translate(-50%, -50%) scale(1);
  }
  .my-list-section h2 {
    color: #333;
    margin-bottom: 20px;
    font-size: 24px;
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .my-list-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 20px;
  }
  .close-mylist-btn {
    margin-top: 20px;
    padding: 12px;
    background: var(--primary);
    color: white;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 16px;
    width: 100%;
    font-weight: 600;
    transition: background 0.2s;
  }
  .close-mylist-btn:hover { background: var(--primary-hover); }

  /* Dock */
  .dock-container {
    position: fixed;
    bottom: 25px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 15px;
    padding: 12px 20px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-radius: 25px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
    border: 1px solid rgba(255,255,255,0.5);
    z-index: 100;
  }
  .dock-item {
    width: 45px;
    height: 45px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
    background: #f5f5f5;
    border: 2px solid transparent;
    position: relative;
  }
  .dock-item:hover {
    transform: translateY(-5px);
    background: var(--primary);
    border-color: var(--primary);
  }
  .dock-item:hover svg { fill: white; }
  .dock-item svg {
    width: 22px;
    height: 22px;
    fill: #666;
    transition: fill 0.2s;
  }
  .dock-item.mylist-btn {
    background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
  }
  .dock-item.mylist-btn svg { fill: white; }
  .dock-item.settings-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }
  .dock-item.settings-btn svg { fill: white; }
  .dock-item.presentation-btn {
    background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
  }
  .dock-item.presentation-btn svg { fill: white; }
  .dock-item.chat-btn {
    background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
  }
  .dock-item.chat-btn svg { fill: #333; }
  .dock-item.apps-btn {
    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
  }
  .dock-item.apps-btn svg { fill: white; }
  .dock-item .badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: #e60012;
    color: white;
    font-size: 11px;
    font-weight: bold;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Window styling */
  .window {
    position: fixed; 
    top: 50%; 
    left: 50%; 
    transform: translate(-50%, -50%) scale(0.95);
    width: 85%; 
    height: 85%; 
    background: white; 
    border-radius: 20px;
    box-shadow: 0 25px 80px rgba(0,0,0,0.3); 
    z-index: 1000;
    display: flex; 
    flex-direction: column; 
    overflow: hidden;
    border: 1px solid #eee;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s ease;
  }
  .window.active { 
    opacity: 1; 
    pointer-events: all;
    transform: translate(-50%, -50%) scale(1);
  }
  .window.large {
    width: 90%;
    height: 90%;
  }
  .topbar {
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    padding: 12px 20px; 
    background: #f8f9fa; 
    border-bottom: 1px solid #eee;
  }
  .topbar span { 
    color: #333; 
    font-weight: 600;
    font-size: 16px;
  }
  .topbar button { 
    background: #e0e0e0; 
    border: none; 
    color: #333; 
    width: 30px;
    height: 30px;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
  }
  .topbar button:hover { 
    background: #e60012;
    color: white; 
  }
  #frame { 
    flex: 1; 
    width: 100%; 
    border: none; 
    background: white; 
  }

  /* Settings panel */
  .settings {
    position: fixed; 
    top: 50%; 
    left: 50%; 
    transform: translate(-50%, -50%) scale(0.95);
    background: white; 
    padding: 30px; 
    border-radius: 24px;
    box-shadow: 0 25px 80px rgba(0,0,0,0.2); 
    z-index: 1001;
    max-width: 500px; 
    width: 90%;
    border: 1px solid #eee;
    max-height: 80vh;
    overflow-y: auto;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s ease;
  }
  .settings.active { 
    opacity: 1; 
    pointer-events: all;
    transform: translate(-50%, -50%) scale(1);
  }
  .settings h3 { 
    color: #333; 
    margin-top: 24px; 
    margin-bottom: 16px; 
    font-size: 18px;
    font-weight: 600;
    padding-bottom: 8px;
    border-bottom: 2px solid var(--primary);
  }
  .settings h3:first-child { margin-top: 0; }
  .settings button {
    margin: 6px; 
    padding: 10px 16px; 
    background: #f0f0f0;
    border: 1px solid #ddd; 
    border-radius: 12px;
    color: #333; 
    cursor: pointer; 
    font-size: 13px; 
    transition: all 0.2s;
  }
  .settings button:hover { 
    background: var(--primary); 
    color: white;
    transform: translateY(-1px);
    border-color: transparent;
  }
  .settings input {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    background: #f5f5f5;
    border: 1px solid #ddd;
    border-radius: 12px;
    color: #333;
    font-size: 14px;
  }
  .settings input::placeholder { color: #999; }

  /* Visitor Counter */
  .visitor-counter {
    position: fixed;
    bottom: 100px;
    right: 20px;
    background: white;
    padding: 10px 20px;
    border-radius: 30px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    font-size: 14px;
    color: #666;
    z-index: 50;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .visitor-counter span {
    color: var(--primary);
    font-weight: bold;
    font-size: 16px;
  }

  /* Overlay */
  .overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: 999;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
  }
  .overlay.active {
    opacity: 1;
    pointer-events: all;
  }

  /* No games message */
  .no-games {
    text-align: center;
    color: #666;
    padding: 40px;
    font-size: 16px;
    width: 100%;
  }

  /* Loading indicator */
  .loading-games {
    text-align: center;
    color: #666;
    padding: 40px;
    font-size: 18px;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  .spinner {
    width: 20px;
    height: 20px;
    border: 3px solid #f3f3f3;
    border-top: 3px solid var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div class="login-screen" id="loginScreen">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSEtseCaQReYgXH1C-tdRM6kNttqlXvFyym_g&s" alt="CodeLearn" class="login-banner">
  <div class="login-box">
    <h1>üîí Student Login</h1>
    <p>Welcome to CodeLearn Programming Portal</p>
    <input type="text" class="login-input" id="username" placeholder="Username" autocomplete="off">
    <input type="password" class="login-input" id="password" placeholder="Password">
    <button class="login-btn" onclick="checkLogin()">Sign In</button>
    <div class="error-msg" id="errorMsg">Invalid username or password!</div>
    
    <!-- More Info Section -->
    <div class="more-info-container">
      <button class="more-info-btn" onclick="toggleInfo()">‚ÑπÔ∏è More Info</button>
      <div class="info-tooltip" id="infoTooltip">
        <p><strong>Username:</strong> 1</p>
        <p><strong>Password:</strong> blockmelol</p>
      </div>
    </div>
  </div>
</div>

<!-- INTRO SCREEN -->
<div class="intro-screen" id="introScreen">
  <img src="https://68.media.tumblr.com/ecea9391e51144ebfb48c0451f11ee70/tumblr_oh98s6US8x1qjoleso1_500.gif" alt="Loading" class="intro-gif">
  <div class="intro-text">Loading your workspace...</div>
</div>

<!-- FEEDBACK POPUP -->
<div class="feedback-popup" id="feedbackPopup">
  <h2>üí≠ We Value Your Feedback!</h2>
  <p>What should I add to Classroom Spot?<br>If you like Classroom Spot, please vote for us!</p>
  <div class="feedback-buttons">
    <button class="feedback-btn vote-btn" onclick="voteSite()">üó≥Ô∏è Vote</button>
    <button class="feedback-btn exit-btn" onclick="closeFeedback()">‚úï Exit</button>
  </div>
</div>

<!-- MAIN SITE -->
<div class="main-site" id="mainSite">
  <div class="header">
    <div class="logo-section">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSEtseCaQReYgXH1C-tdRM6kNttqlXvFyym_g&s" alt="CodeLearn" class="logo-banner">
      <span class="site-title">CodeLearn</span>
    </div>
    <div class="header-controls">
      <!-- Search Bar -->
      <div class="search-container">
        <span class="search-icon">üîç</span>
        <input type="text" class="search-input" id="searchInput" placeholder="Search games..." oninput="handleSearch()">
      </div>
      <span class="total-games" id="totalGames">Total Games: Loading...</span>
      <span class="time-display" id="clock">12:00 PM</span>
    </div>
  </div>

  <!-- Games Container - Nintendo Switch Style Horizontal Scroll -->
  <div class="games-container">
    <!-- Scroll Buttons -->
    <button class="scroll-btn scroll-btn-left" onclick="scrollGamesLeft()">
      <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    </button>
    <button class="scroll-btn scroll-btn-right" onclick="scrollGamesRight()">
      <svg viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
    </button>
    
    <div class="games-scroll-area" id="gamesScrollArea">
      <div class="games-row" id="gamesRow">
        <div class="loading-games">
          <div class="spinner"></div>
          Loading games...
        </div>
      </div>
    </div>
  </div>
</div>

<!-- FULLSCREEN GAME PLAYER -->
<div class="game-player" id="gamePlayer">
  <div class="game-player-header">
    <button class="home-btn" onclick="closeGame()">
      <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
      Home
    </button>
    <span class="game-player-title" id="gamePlayerTitle">Game</span>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">
      <svg viewBox="0 0 24 24"><path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/></svg>
      Fullscreen
    </button>
  </div>
  <iframe class="game-frame" id="gameFrame" sandbox="allow-scripts allow-same-origin allow-popups allow-forms allow-pointer-lock"></iframe>
  
  <!-- Fullscreen Exit Overlay -->
  <div class="fullscreen-exit-overlay" id="fullscreenExitOverlay">
    <button class="fullscreen-exit-btn" onclick="exitFullscreen()">‚úï</button>
  </div>
</div>

<!-- Visitor Counter -->
<div class="visitor-counter" id="visitorCounter">
  üë• Visitors: <span id="visitorCount">1257</span>
</div>

<!-- My List Section -->
<div class="my-list-section" id="myListSection">
  <h2>‚≠ê My List (<span id="myListCount">0</span>)</h2>
  <div class="my-list-grid" id="myListGrid"></div>
  <button class="close-mylist-btn" onclick="closeMyList()">Close</button>
</div>

<!-- Overlay for modals -->
<div class="overlay" id="overlay" onclick="closeAllModals()"></div>

<!-- Dock -->
<div class="dock-container">
  <div class="dock-item" onclick="openWindow('movies.html','Movies')" title="Movies">
    <svg viewBox="0 0 24 24"><path d="M18 3v2h-2V3H8v2H6V3H4v18h2v-2h2v2h8v-2h2v2h2V3h-2zM8 17H6v-2h2v2zm0-4H6v-2h2v2zm0-4H6V7h2v2zm10 8h-2v-2h2v2zm0-4h-2v-2h2v2zm0-4h-2V7h2v2z"/></svg>
  </div>
  <div class="dock-item" onclick="openWindow('partners.html','Partners')" title="Partners">
    <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
  </div>
  <div class="dock-item" onclick="openWindow('unblockers.html','Unblocker')" title="Unblocker">
    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
  </div>
  <div class="dock-item mylist-btn" onclick="openMyList()" title="My List">
    <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
    <span class="badge" id="myListBadge" style="display: none;">0</span>
  </div>
  <div class="dock-item presentation-btn" onclick="openPresentation()" title="Presentation">
    <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
  </div>
  <div class="dock-item chat-btn" onclick="openChat()" title="Chat">
    <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/></svg>
  </div>
  <div class="dock-item apps-btn" onclick="openApps()" title="Apps">
    <svg viewBox="0 0 24 24"><path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"/></svg>
  </div>
  <div class="dock-item settings-btn" onclick="openSettings()" title="Settings">
    <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L5.09 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
  </div>
</div>

<div id="window" class="window">
  <div class="topbar">
    <span id="windowTitle">App</span>
    <button onclick="closeWindow()">‚úï</button>
  </div>
  <iframe id="frame"></iframe>
</div>

<div id="settings" class="settings">
  <h3>üé® Wallpapers</h3>
  <button onclick="setWallpaper('goku')">Goku</button>
  <button onclick="setWallpaper('goku2')">Goku 2</button>
  <button onclick="setWallpaper('naruto')">Naruto</button>
  <button onclick="setWallpaper('surfer')">Silver Surfer</button>
  <button onclick="setWallpaper('surfer2')">Silver Surfer 2</button>
  <button onclick="setWallpaper('onepiece')">One Piece</button>
  <button onclick="setWallpaper('jjk')">JJK</button>
  <button onclick="setWallpaper('roblox')">Roblox</button>
  <button onclick="setWallpaper('fortnite')">Fortnite</button>
  <button onclick="setWallpaper('dbz')">Dragon Ball Z</button>

  <h3>üé≠ Cloak</h3>
  <button onclick="openAboutBlank()">Open about:blank</button>
  <input id="cloakInput" placeholder="Tab name">
  <button onclick="setCloak()">Apply Cloak</button>
  <br><br>
  <button onclick="closeSettings()">Close Settings</button>
</div>

<script>
// FIXED WALLPAPERS - All HTTPS verified working URLs
const wallpapers = {
  'goku': 'https://images.alphacoders.com/133/1331018.png',
  'goku2': 'https://images.alphacoders.com/133/1330466.png',
  'naruto': 'https://images.alphacoders.com/133/1331323.png',
  'surfer': 'https://images.alphacoders.com/140/1401469.png',
  'surfer2': 'https://images.alphacoders.com/101/101518.jpg',
  'onepiece': 'https://images.alphacoders.com/132/1323165.png',
  'jjk': 'https://images.alphacoders.com/128/1289274.jpg',
  'roblox': 'https://images.alphacoders.com/119/1198871.jpg',
  'fortnite': 'https://images.alphacoders.com/121/1213851.jpg',
  'dbz': 'https://images.alphacoders.com/133/1330365.png'
};

// Clock
function updateClock() {
  const now = new Date();
  const timeString = now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
  document.getElementById('clock').textContent = timeString;
}
setInterval(updateClock, 1000);
updateClock();

// Visitor Counter - Starts at 1257
function updateVisitorCounter() {
  let count = localStorage.getItem('visitorCount');
  if (!count) {
    count = 1256; 
  }
  count = parseInt(count) + 1;
  localStorage.setItem('visitorCount', count);
  document.getElementById('visitorCount').textContent = count.toLocaleString();
}
updateVisitorCounter();

// More Info Toggle
function toggleInfo() {
  const tooltip = document.getElementById('infoTooltip');
  tooltip.classList.toggle('active');
}

// Feedback Popup
function showFeedback() {
  const popup = document.getElementById('feedbackPopup');
  popup.classList.add('active');
}

function closeFeedback() {
  const popup = document.getElementById('feedbackPopup');
  popup.classList.remove('active');
}

function voteSite() {
  window.open('https://ubghub.org/?site=classroomspot', '_blank');
  closeFeedback();
}

// Favorites System
let favorites = JSON.parse(localStorage.getItem('codeLearnFavorites')) || [];

function toggleFavorite(gameName, event) {
  event.stopPropagation();
  const index = favorites.indexOf(gameName);
  if (index > -1) {
    favorites.splice(index, 1);
  } else {
    favorites.push(gameName);
  }
  localStorage.setItem('codeLearnFavorites', JSON.stringify(favorites));
  updateMyListBadge();
  renderGames();
}

function isFavorite(gameName) {
  return favorites.includes(gameName);
}

function updateMyListBadge() {
  const badge = document.getElementById('myListBadge');
  badge.textContent = favorites.length;
  badge.style.display = favorites.length > 0 ? 'flex' : 'none';
  document.getElementById('myListCount').textContent = favorites.length;
}

// Login System
function checkLogin() {
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;
  const errorMsg = document.getElementById('errorMsg');
  
  if (username === '1' && password === 'blockmelol') {
    document.getElementById('loginScreen').classList.add('hidden');
    document.getElementById('introScreen').classList.add('active');
    
    setTimeout(() => {
      document.getElementById('introScreen').classList.remove('active');
      document.getElementById('mainSite').classList.add('active');
      loadGames();
      updateMyListBadge();
      showFeedback();
    }, 3000);
  } else {
    errorMsg.style.display = 'block';
    setTimeout(() => {
      errorMsg.style.display = 'none';
    }, 3000);
  }
}

// Allow Enter key to login
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('password').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') checkLogin();
  });
  document.getElementById('username').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') document.getElementById('password').focus();
  });
});

// My List Functions
function openMyList() {
  const section = document.getElementById('myListSection');
  const grid = document.getElementById('myListGrid');
  const overlay = document.getElementById('overlay');
  
  grid.innerHTML = '';
  
  const favGames = allGames.filter(g => favorites.includes(g.name));
  
  if (favGames.length === 0) {
    grid.innerHTML = '<p style="color: #666; text-align: center; grid-column: 1/-1;">No favorites yet! Click the ‚≠ê on games to add them.</p>';
  } else {
    favGames.forEach(game => {
      const card = createGameCard(game, true);
      grid.appendChild(card);
    });
  }
  
  section.classList.add('active');
  overlay.classList.add('active');
}

function closeMyList() {
  document.getElementById('myListSection').classList.remove('active');
  document.getElementById('overlay').classList.remove('active');
}

// Games Data
let allGames = [];
let filteredGames = [];
let focusedIndex = 0;

const ZONES = "https://cdn.jsdelivr.net/gh/gn-math/assets@main/zones.json";
const COVER = "https://cdn.jsdelivr.net/gh/gn-math/covers@main/";
const HTML_URL = "https://cdn.jsdelivr.net/gh/gn-math/html@main/";

// Custom game images
const ROBLOX_IMAGE = "https://tse3.mm.bing.net/th/id/OIP.Suu0wkaP6duvpXY_gWJucgAAAA?rs=1&pid=ImgDetMain&o=7&rm=3";
const GTA_IMAGE = "https://tse2.mm.bing.net/th/id/OIP.T6kQS4BQ4CCT6jlXGtAuDgHaE7?rs=1&pid=ImgDetMain&o=7&rm=3";
const SUBWAY_SURFERS_IMAGE = "https://static.wikia.nocookie.net/subwaysurf/images/4/4b/FirstAvatar.jpg/revision/latest/scale-to-width-down/200?cb=20250319180337";
const AMONG_US_IMAGE = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRcG8oF3z56u00DxA_RAGa-iv5ojB1Al1NZbA&s";
const SUPER_SMASH_BROS_IMAGE = "https://assets-prd.ignimgs.com/2022/02/28/ssb-ignedit-dontsteal-1646008911034.jpg";
const GD_LITE_IMAGE = "https://play-lh.googleusercontent.com/p7kWbWBFxQIrzolEqiV5uSvctLeyssZvBV7UBOX29wzZI52IdcSs4qCB_zsQJL1mt9A";
const CLASH_ROYALE_IMAGE = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQb-0vYEFuRzD8sX_ClyriT393uJchdjI_RZx11z4PE8w&s";

function createGameCard(game, isMyList = false) {
  const card = document.createElement("div");
  card.className = "game-card";
  if (isFavorite(game.name)) {
    card.classList.add('favorite');
  }
  
  if (game.cover) {
    const img = document.createElement("img");
    img.src = game.cover;
    img.alt = game.name;
    img.loading = "lazy";
    img.onerror = function() {
      // Fallback if image fails to load
      this.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><rect width="200" height="200" fill="%23667eea"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" fill="white" font-family="Arial" font-size="16">' + game.name + '</text></svg>';
    };
    card.appendChild(img);
  }
  
  // Favorite star button
  const star = document.createElement("span");
  star.className = "star" + (isFavorite(game.name) ? "" : " empty");
  star.innerHTML = isFavorite(game.name) ? "‚òÖ" : "‚òÜ";
  star.onclick = (e) => toggleFavorite(game.name, e);
  card.appendChild(star);
  
  const title = document.createElement("div");
  title.className = "title";
  title.textContent = game.name;
  card.appendChild(title);
  
  card.onclick = () => {
    openGame(game);
  };
  
  return card;
}

async function loadGames() {
  const row = document.getElementById('gamesRow');
  
  try {
    // Fetch with timeout and cache busting
    const controller = new AbortController();
    const timeoutId = setTimeout(() => controller.abort(), 10000);
    
    const response = await fetch(ZONES + "?t=" + Date.now(), {
      signal: controller.signal,
      headers: {
        'Accept': 'application/json'
      }
    });
    
    clearTimeout(timeoutId);
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }
    
    const data = await response.json();
    
    if (!Array.isArray(data)) {
      throw new Error('Invalid data format');
    }
    
    // Filter out unwanted games and map to proper format
    const apiGames = data.filter(g => {
      if (!g || !g.name) return false;
      const name = g.name.toLowerCase();
      return !name.includes("!suggest") && 
             !name.includes(".gg") && 
             !name.includes("!comments") &&
             !name.includes("[!]") &&
             !name.includes("suggestion") &&
             !name.includes("comment");
    }).map(g => ({
      name: g.name,
      cover: g.cover ? g.cover.replace("{COVER_URL}", COVER).replace("{HTML_URL}", HTML_URL) : '',
      url: g.url ? g.url.replace("{COVER_URL}", COVER).replace("{HTML_URL}", HTML_URL) : '',
      external: g.url && g.url.startsWith("http"),
      star: false
    }));
    
    // Combine with custom games - ROBLOX NOW USES DIRECT URL
    allGames = [
      { name: "Roblox", cover: ROBLOX_IMAGE, url: "https://idontixlsomakets.vercel.app/test33.html", external: true, star: true },
      { name: "GTA Vice City", cover: GTA_IMAGE, url: "https://t9os.space/gtavc.html", external: true, star: false },
      { name: "Subway Surfers", cover: SUBWAY_SURFERS_IMAGE, url: "https://seraph-embeds.vercel.app/games/subwaysurfers/index.html", external: true, star: false },
      { name: "Among Us", cover: AMONG_US_IMAGE, url: "https://seraph-embeds.vercel.app/games/amongus/index.html", external: true, star: false },
      { name: "Super Smash Bros", cover: SUPER_SMASH_BROS_IMAGE, url: "https://seraph-embeds.vercel.app/games/supersmashbros/index.html", external: true, star: false },
      { name: "GD Lite", cover: GD_LITE_IMAGE, url: "https://seraph-embedding.vercel.app/games/gdlite/index.html", external: true, star: false },
      { name: "Clash Royale", cover: CLASH_ROYALE_IMAGE, url: "https://t9os.vercel.app/clash.html", external: true, star: false },
      ...apiGames
    ];
    
    filteredGames = [...allGames];
    
    // Update counter
    document.getElementById('totalGames').textContent = `Total Games: ${allGames.length}`;
    
    // Render games
    renderGames();
    
  } catch (err) {
    console.error("Error loading games:", err);
    
    // Fallback to just custom games if API fails
    allGames = [
      { name: "Roblox", cover: ROBLOX_IMAGE, url: "https://idontixlsomakets.vercel.app/test33.html", external: true, star: true },
      { name: "GTA Vice City", cover: GTA_IMAGE, url: "https://t9os.space/gtavc.html", external: true, star: false },
      { name: "Subway Surfers", cover: SUBWAY_SURFERS_IMAGE, url: "https://seraph-embeds.vercel.app/games/subwaysurfers/index.html", external: true, star: false },
      { name: "Among Us", cover: AMONG_US_IMAGE, url: "https://seraph-embeds.vercel.app/games/amongus/index.html", external: true, star: false },
      { name: "Super Smash Bros", cover: SUPER_SMASH_BROS_IMAGE, url: "https://seraph-embeds.vercel.app/games/supersmashbros/index.html", external: true, star: false },
      { name: "GD Lite", cover: GD_LITE_IMAGE, url: "https://seraph-embedding.vercel.app/games/gdlite/index.html", external: true, star: false },
      { name: "Clash Royale", cover: CLASH_ROYALE_IMAGE, url: "https://t9os.vercel.app/clash.html", external: true, star: false }
    ];
    filteredGames = [...allGames];
    
    document.getElementById('totalGames').textContent = `Total Games: ${allGames.length} (API Error)`;
    renderGames();
    
    // Show error in games row
    row.innerHTML = `<div class="no-games">Failed to load games from server. Showing fallback games.<br>Error: ${err.message}</div>`;
  }
}

// Search Functionality
function handleSearch() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  if (query === '') {
    filteredGames = [...allGames];
  } else {
    filteredGames = allGames.filter(game => game.name.toLowerCase().includes(query));
  }
  focusedIndex = 0;
  renderGames();
}

function renderGames() {
  const row = document.getElementById('gamesRow');
  row.innerHTML = '';
  
  if (filteredGames.length === 0) {
    row.innerHTML = '<div class="no-games">No games found matching your search.</div>';
    return;
  }
  
  filteredGames.forEach((game, index) => {
    const card = createGameCard(game);
    if (index === focusedIndex) {
      card.classList.add('focused');
    }
    row.appendChild(card);
  });
}

// Scroll Button Functions
function scrollGamesLeft() {
  const scrollArea = document.getElementById('gamesScrollArea');
  scrollArea.scrollBy({ left: -500, behavior: 'smooth' });
}

function scrollGamesRight() {
  const scrollArea = document.getElementById('gamesScrollArea');
  scrollArea.scrollBy({ left: 500, behavior: 'smooth' });
}

// Fullscreen Game Player - Fixed to properly load games
function openGame(game) {
  const player = document.getElementById('gamePlayer');
  const frame = document.getElementById('gameFrame');
  const title = document.getElementById('gamePlayerTitle');
  
  title.textContent = game.name;
  player.classList.add('active');
  
  if (game.external) {
    // For external URLs - load directly in iframe
    frame.src = game.url;
  } else if (game.url) {
    // For gn-math games - fetch the HTML content
    fetch(game.url + "?t=" + Date.now())
      .then(response => response.text())
      .then(html => {
        frame.srcdoc = html;
      })
      .catch(error => {
        console.error("Failed to load game:", error);
        frame.srcdoc = `<html><body style="background:#000;color:#fff;display:flex;align-items:center;justify-content:center;font-family:sans-serif;"><h2>Failed to load game. Please try again.</h2></body></html>`;
      });
  }
}

function closeGame() {
  const player = document.getElementById('gamePlayer');
  const frame = document.getElementById('gameFrame');
  
  player.classList.remove('active');
  frame.src = '';
  frame.srcdoc = '';
}

// Fullscreen functionality
function toggleFullscreen() {
  const player = document.getElementById('gamePlayer');
  
  if (!document.fullscreenElement) {
    player.requestFullscreen().then(() => {
      player.classList.add('fullscreen');
    }).catch(err => {
      console.error('Error attempting to enable fullscreen:', err);
    });
  } else {
    exitFullscreen();
  }
}

function exitFullscreen() {
  if (document.fullscreenElement) {
    document.exitFullscreen().then(() => {
      document.getElementById('gamePlayer').classList.remove('fullscreen');
    });
  }
}

// Listen for escape key and fullscreen changes
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && document.fullscreenElement) {
    exitFullscreen();
  }
});

document.addEventListener('fullscreenchange', () => {
  if (!document.fullscreenElement) {
    document.getElementById('gamePlayer').classList.remove('fullscreen');
  }
});

// Show exit overlay when mouse is at top of screen in fullscreen
document.getElementById('gamePlayer').addEventListener('mousemove', (e) => {
  const player = document.getElementById('gamePlayer');
  const overlay = document.getElementById('fullscreenExitOverlay');
  
  if (player.classList.contains('fullscreen')) {
    if (e.clientY < 100) {
      overlay.style.opacity = '1';
    } else {
      overlay.style.opacity = '0';
    }
  }
});

// Window Functions
function openWindow(url, title) {
  const win = document.getElementById('window');
  const frame = document.getElementById('frame');
  const titleSpan = document.getElementById('windowTitle');
  const overlay = document.getElementById('overlay');
  
  // Remove large class if present
  win.classList.remove('large');
  
  frame.src = url; 
  titleSpan.textContent = title; 
  win.classList.add('active');
  overlay.classList.add('active');
}

function closeWindow() {
  const win = document.getElementById('window');
  const frame = document.getElementById('frame');
  const overlay = document.getElementById('overlay');
  
  win.classList.remove('active');
  overlay.classList.remove('active');
  setTimeout(() => {
    frame.src = ''; 
  }, 300);
}

function closeAllModals() {
  closeWindow();
  closeSettings();
  closeMyList();
}

// Settings
function openSettings() { 
  document.getElementById('settings').classList.add('active'); 
  document.getElementById('overlay').classList.add('active');
}

function closeSettings() { 
  document.getElementById('settings').classList.remove('active'); 
  document.getElementById('overlay').classList.remove('active');
}

function setWallpaper(name) {
  const url = wallpapers[name];
  if (url) {
    document.body.style.backgroundImage = `url('${url}')`;
    document.body.style.backgroundSize = 'cover';
    document.body.style.backgroundPosition = 'center';
    document.body.style.backgroundRepeat = 'no-repeat';
    document.body.style.backgroundAttachment = 'fixed';
    localStorage.setItem('selectedWallpaper', name);
  }
}

function openAboutBlank() {
  const win = window.open('about:blank', '_blank');
  if (win) {
    win.document.write(`<!DOCTYPE html><html><head><title>about:blank</title><style>body{margin:0;padding:0;background:#000;overflow:hidden;}#cloak-frame{position:fixed;top:0;left:0;width:100vw;height:100vh;border:none;}</style></head><body><iframe id="cloak-frame" src="${window.location.href}"></iframe><script>setInterval(function(){window.history.replaceState({},'about:blank','about:blank');},100);<\/script></body></html>`);
    win.document.close();
  }
}

function setCloak() {
  const name = document.getElementById('cloakInput').value || 'about:blank';
  document.title = name;
  const link = document.querySelector("link[rel*='icon']") || document.createElement('link');
  link.type = 'image/x-icon'; 
  link.rel = 'shortcut icon'; 
  link.href = 'data:image/x-icon;base64,';
  document.getElementsByTagName('head')[0].appendChild(link);
  history.pushState({}, name, 'about:blank');
}

// Initialize wallpaper
document.addEventListener('DOMContentLoaded', () => {
  const savedWallpaper = localStorage.getItem('selectedWallpaper');
  if (savedWallpaper && wallpapers[savedWallpaper]) {
    setWallpaper(savedWallpaper);
  }
});

// Presentation Preview Function
function openPresentation() {
  const win = document.getElementById('window');
  const frame = document.getElementById('frame');
  const titleSpan = document.getElementById('windowTitle');
  const overlay = document.getElementById('overlay');
  
  // Convert Google Docs URL to embed format
  const presentationId = '1JJQOdkUf9OzWWcyqJznDTLdD3KTmc2Qkl85ibqx-JxM';
  const embedUrl = `https://docs.google.com/presentation/d/${presentationId}/embed?start=false&loop=false&delayms=3000`;
  
  // Use larger window for presentation
  win.classList.add('large');
  
  frame.src = embedUrl; 
  titleSpan.textContent = 'üìä Presentation Preview'; 
  win.classList.add('active');
  overlay.classList.add('active');
}

// Chat Preview Function
function openChat() {
  const win = document.getElementById('window');
  const frame = document.getElementById('frame');
  const titleSpan = document.getElementById('windowTitle');
  const overlay = document.getElementById('overlay');
  
  // Use larger window for chat
  win.classList.add('large');
  
  frame.src = 'https://t9os.space/chat3.html'; 
  titleSpan.textContent = 'üí¨ Chat Preview'; 
  win.classList.add('active');
  overlay.classList.add('active');
}

// Apps Preview Function
function openApps() {
  const win = document.getElementById('window');
  const frame = document.getElementById('frame');
  const titleSpan = document.getElementById('windowTitle');
  const overlay = document.getElementById('overlay');
  
  // Use larger window for apps
  win.classList.add('large');
  
  frame.src = 'https://t9os.space/a.html'; 
  titleSpan.textContent = 'üì± Apps'; 
  win.classList.add('active');
  overlay.classList.add('active');
}
</script>

</body>
</html>
